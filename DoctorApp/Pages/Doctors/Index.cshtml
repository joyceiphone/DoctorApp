@page
@model DoctorApp.Pages.Doctors.IndexModel
@{
	ViewData["Title"] = "Doctors";
}

<h3>@ViewData["Title"]</h3>

<p>
	<a asp-page="Create" class="btn btn-primary">Create</a>
</p>

<form method="post">
	<div class="mb-4 d-flex">
		<select class="form-select form-select-sm" asp-for="selectedId" asp-items="Model.Options">
		</select>
		<button class="primary mx-2 btn btn-primary" name="command" value="FilterAction" type="submit">
			Filter
		</button>
	</div>

	<div>
		<table id="example" data-sortable="true" class="table table-striped table-responsive table-hover full-width-table">
			<thead>
				<tr>
					<th data-field="Id" data-sortable="true">
						@Html.DisplayNameFor(model => model.Doctors[0].Id)
					</th>
					<th>
						CheckBox
					</th>
					<th data-field="DrLName" data-sortable="true">
						@Html.DisplayNameFor(model => model.Doctors[0].DrLName)
					</th>
					<th data-field="DrFName" data-sortable="true">
						@Html.DisplayNameFor(model => model.Doctors[0].DrFName)
					</th>
					<th data-field="Specialty" data-sortable="true">
						@Html.DisplayNameFor(model => model.Doctors[0].Specialty)
					</th>
					<th>
						Action
					</th>
				</tr>
			</thead>
			<tbody>
				@if (Model != null && Model.JoinedResult.Any())
				{
					foreach (var doctor in Model.JoinedResult)
					{
						<tr>
							<td>
								@Html.DisplayFor(item => doctor.Id)
							</td>
							<td>
								<!-- Use the for attribute to associate the checkbox with the property -->
								<div class="form-check">
									<input class="form-check-input" name="CheckedItems" type="checkbox" value="@doctor.Id">
								</div>
							</td>
							<td>
								@Html.DisplayFor(item => doctor.DrLName)
							</td>
							<td>
								@Html.DisplayFor(item => doctor.DrFName)
							</td>
							<td>
								@Html.DisplayFor(item => doctor.SpecialityName)
							</td>
							<td>
								<a asp-page="./Edit" asp-route-itemid="@doctor.Id" class="btn btn-primary">Edit</a>
								<a asp-page="./Details" asp-route-itemid="@doctor.Id" class="btn btn-success">Details</a>
								<a asp-page="./Delete" asp-route-itemid="@doctor.Id" class="btn btn-danger">Delete</a>
							</td>
						</tr>
					}
				}
			</tbody>
		</table>

		<hr />
		<!-- Print Modal -->

		<div id="printModal" class="modal fade" role="dialog">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">
					<div class="modal-header flex justify-content-center">
						<h4 style="text-align:center;">Enter Patient Account number</h4>
					</div>
					<div class="modal-body mb-4">
						<div class="row mb-4 m-1">
							<label class="col-md-3 col-form-label">Patient Acc</label>
							<div class="col-sm-8">
								<input asp-for="PtAccNum" class="form-control" />
								<span asp-validation-for="PtAccNum" class="text-danger"></span>
							</div>
						</div>
						<div style="display: flex; justify-content: space-between" class="mx-2">
							<button type="submit" name="command" id="printItem" value="PrintCheckedItems" class="btn btn-primary px-4">Print</button>
							<button type="button" id="cancelModal" class="btn btn-secondary px-4" data-dismiss="modal">Cancel</button>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Ensure the Print button is within the form -->
		<p>
			<button id="print" class="btn btn-primary">Print</button>
		</p>
	</div>
</form>

@section Scripts{
	@{
		await Html.RenderPartialAsync("_ValidationScriptsPartial");
	}

	<script>
		$('document').ready(function () {
			$('#print').click(function (e) {
				e.preventDefault();
				$('#printModal').modal('show');
			})
			$('#cancelModal').click(function (e) {
				//e.preventDefault();
				$('#printModal').modal('hide');
			})
			$('#printItem').click(function (e) {
				setTimeout(() => {
					$('#printModal').modal('hide');
				}, 1000);
			}),
			$('#example').bootstrapTable();
		})
	</script>
}